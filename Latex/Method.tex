\subsection{Study design and registration}
This meta-analysis followed a predefined analytic protocol focusing on adverse events (AEs) reported in controlled psychedelic trials. No formal prospective registration (e.g., PROSPERO) was completed; protocol materials and analytic scripts are archived with the project repository.

\subsection{Eligibility criteria and information sources}
We included randomized or otherwise controlled human studies evaluating 3,4-methylenedioxymethamphetamine (MDMA), lysergic acid diethylamide (LSD), psilocybin, or ayahuasca, provided that at least one study arm reported systematically collected AEs. Inactive placebos were preferred as reference arms; when unavailable, the lowest active dose within a molecule-specific hierarchy was used. Reports lacking clear dosing, duplicate publications, animal studies, and case series without systematic AE collection were excluded. Searches covered major bibliographic databases (e.g., PubMed), trial registries (e.g., ClinicalTrials.gov), and grey literature sources (e.g., Cochrane Central) without date restrictions. Reference lists of eligible publications were screened to identify additional trials.

\subsection{Data extraction and items}
Study-level information was abstracted into a harmonized dataset comprising the following variables: study identifier, molecule, arm identifier, number of participants per arm, AE term (\texttt{ae\_term}) mapped to a controlled vocabulary, assessment window (acute \emph{session} vs. longer-term \emph{follow-up}), number of participants experiencing each AE (counts derived directly or back-calculated from reported proportions), and administered dose in milligrams (with conversions from mg/kg where required). The analytic dataset also captured contextual variables such as placebo type (inactive vs. active) and visit schedule. Arm- and molecule-level counts contributing to each analysis stage are summarised in \Cref{tab:study-characteristics}. Data extraction was performed independently by two analysts using standardized templates; discrepancies were resolved by consensus.

\subsection{Data harmonization and preprocessing}
Raw spreadsheets were imported through a custom R ingestion pipeline that standardised column names, normalised accented characters, and coerced numeric fields to milligram doses and participant counts. Where adverse event counts were reported as proportions, they were multiplied by the corresponding arm size and rounded to integers. Control-arm labels were normalised to \texttt{inactive\_placebo}, \texttt{active\_placebo}, or \texttt{active\_non\_psy\_placebo}; when arm types were missing, inactive placebos were inferred from zero-dose arms containing the string ``placebo,'' otherwise arms were labelled \texttt{active}. Within each study-by-molecule subset, the preferred reference arm was selected by applying a molecule-specific hierarchy prioritising inactive placebos, then active placebos, and finally the lowest active dose.

\subsection{Effect size construction}
Harmonised arm-level data were converted into $2\times2$ contingency tables contrasting each active dose with the selected reference arm. Odds ratios were computed using \texttt{metafor::escalc} with a Haldane--Anscombe correction of 0.5 applied only to zero cells. Resulting log-odds ratios ($y_i$) and sampling variances ($v_i$) retained the original dose (mg) assigned to the active arm, the reference-arm dose, and the dose difference required for downstream dose--response modelling. Study identifiers, molecule labels, adverse-event terms, and time windows were preserved to support stratified analyses and plotting workflows.

\subsection{Risk of bias assessment}
Risk of bias assessments were planned using the Cochrane domains for randomized trials. Where publications did not provide sufficient detail for formal scoring, narratives describing allocation concealment, blinding, and attrition were retained for qualitative interpretation. Quantitative syntheses were not down-weighted based on risk-of-bias judgments because structured assessments were unavailable for several legacy studies.

\subsection{Synthesis methods}
For each trial, active arms were paired to the designated reference arm according to the reference-arm policy and analysed on the log-odds-ratio scale. Random-effects meta-analyses using restricted maximum likelihood (REML) were computed for overall AEs and for each harmonized \texttt{ae\_term}. Between-study heterogeneity was quantified using $\tau^2$ (REML) and $I^2$ derived from the Q-statistic. Leave-one-out diagnostics were generated for pooled models where at least three contrasts were available, and funnel plot inspections alongside Egger tests were produced whenever the number of contrasts satisfied the conventional threshold of $k\geq10$.

\subsection{Dose--response modelling and subgroup analyses}
Dose--response relationships were examined through meta-regression of arm-level contrasts. Prespecified linear models and restricted cubic splines were fitted when dose coverage permitted at least three non-reference levels within a molecule. Time-window stratification (session vs. follow-up) was incorporated either through stratified models or interaction terms. Per-AE splines were produced when at least two molecules reported the same harmonized term, enabling cross-molecule overlays. Where applicable, follow-up specific models used the same reference-arm alignment to ensure comparability.

\subsection{Sensitivity analyses}
Sensitivity analyses included leave-one-out recalculations, stratification by assessment window, and molecule-specific contrasts. Additional exploratory summaries contrasted session and follow-up slopes and per-AE significance patterns. Outputs from these analyses are linked in \Cref{tab:topline-summary,tab:cmp_ae_molecule} and \Cref{fig:session-followup}.

\subsection{Statistical software}
All analyses were conducted in R (version 4.3 or later). Key packages included \texttt{metafor} for random-effects models, \texttt{dplyr} and \texttt{tidyr} for data manipulation, \texttt{splines} and \texttt{dosresmeta} for dose--response modelling, and \texttt{ggplot2} with \texttt{patchwork} for visualization. Reproducible scripts, data exports, and figure assets are distributed with the repository.

\IfFileExists{tables/study_characteristics.tex}{%
  \begin{table}[ht]
    \centering
    \caption{Arm-level contributions by molecule. Counts correspond to study-arm contrasts entering meta-analyses after harmonization. Dashes denote windows without available contrasts.}
    \label{tab:study-characteristics}
    \input{tables/study_characteristics.tex}
  \end{table}
}{}
